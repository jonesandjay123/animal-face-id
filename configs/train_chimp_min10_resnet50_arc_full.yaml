name: chimp-min10-resnet50-arcface-full

data:
  dataset_name: chimpanzee_faces
  raw_root: data/chimpanzee_faces/raw
  splits_path: data/chimpanzee_faces/annotations/splits_min10.json
  batch_size: 128          # tuned for RTX 5080 16GB with AMP
  num_workers: 8
  image_size: 224
  num_classes: 87
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]

model:
  backbone: resnet50
  embedding_dim: 256
  head: arcface
  margin: 0.5
  scale: 30.0
  pretrained: true

trainer:
  max_epochs: 200          # full run; extend if curve is still improving
  lr: 0.0004               # slightly lower than trial to stabilize longer training
  weight_decay: 0.01
  scheduler: cosine
  device: cuda
  amp: true
  grad_clip: 1.0
  loss: cross_entropy
  checkpoint_dir: artifacts
  seed: 42

inference:
  checkpoint: artifacts/chimp-min10-resnet50-arcface-full_best.pt
  gallery_path: artifacts/gallery_index.pkl
  knn:
    metric: cosine
    top_k: 5
